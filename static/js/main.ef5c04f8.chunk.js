(this["webpackJsonplego-sw-collection-manager-ts"]=this["webpackJsonplego-sw-collection-manager-ts"]||[]).push([[0],{145:function(e,t,n){},158:function(e,t,n){"use strict";n.r(t);var a,r,i=n(0),c=n.n(i),o=n(15),s=n.n(o),l=(n(145),n(207)),u=n(239),d=n(211),j=n(212),b=n(95),f=n(231),p=n(16),m=n(160),h=n(108),g=n.n(h),O=n(240),x=n(119),v=n(48),y=n(2),w=Object(l.a)((function(e){return Object(u.a)({activeLink:{color:e.palette.primary.main,fontWeight:e.typography.fontWeightBold}})})),k=function(e){var t=e.isAuthenticate,n=e.logoutHandler,a=w(),r=c.a.useState(null),o=Object(p.a)(r,2),s=o[0],l=o[1],u=Boolean(s),d=Object(i.useCallback)((function(){return l(null)}),[]),j=Object(i.useCallback)((function(){d(),n()}),[n,d]);return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(m.a,{"data-testid":"burger-icon","aria-label":"application menu icon","aria-controls":"menu-header","aria-haspopup":"true",onClick:function(e){l(e.currentTarget)},color:"inherit",children:Object(y.jsx)(g.a,{})}),Object(y.jsxs)(x.a,{id:"menu-header",anchorEl:s,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:u,onClose:d,children:[Object(y.jsx)(O.a,{"data-testid":"minifigs",component:v.b,to:"/minifigs",activeClassName:a.activeLink,onClick:d,children:"Minifigs"}),t?Object(y.jsx)(O.a,{onClick:j,children:"Logout"}):Object(y.jsx)(O.a,{"data-testid":"auth",component:v.b,to:"/auth",activeClassName:a.activeLink,onClick:d,children:"Authentication"})]})]})},C=k,N=n(7),S=n(230),I=n(210),P=n(18),A=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},M=function(e){var t=e.isAuthenticate,n=e.logoutHandler,a=Object(P.h)().pathname;return Object(y.jsxs)(S.a,{value:a,"aria-label":"Tab menu",children:[Object(y.jsx)(I.a,Object(N.a)({"data-testid":"minifigs",label:"Minifigs",value:"/minifigs",component:v.a,to:"/minifigs"},A(0))),t?Object(y.jsx)(I.a,{label:"Logout",onClick:n}):Object(y.jsx)(I.a,Object(N.a)({label:"Authentication",component:v.a,to:"/auth",value:"/auth"},A(1)))]})},T=M,L=n(77),W=function(){return Object(L.b)()},D=L.c,F=function(e){var t=Object(i.useRef)();return Object(i.useEffect)((function(){t.current=e}),[e]),t.current},q=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(i.useState)(e),n=Object(p.a)(t,2),a=n[0],r=n[1],c=Object(i.useCallback)((function(e){return r("undefined"!==typeof e?e:function(e){return!e})}),[]);return[a,c]},z=n(9),V=n.n(z),E=n(14),R=n(23),U=n(89),H=n(28),B=Object(H.a)({basename:"/lego-sw-collection-manager-ts"}),Z={token:null,userId:null,error:null,isLoading:!1},J=Object(R.c)("auth/authenticate",function(){var e=Object(E.a)(V.a.mark((function e(t,n){var a,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.rejectWithValue,e.prev=1,e.next=4,U.a.post("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAdpqxJlqETb5zQ155SHnoel4UWUPZejkA",{json:Object(N.a)(Object(N.a)({},t),{},{returnSecureToken:!0})}).json();case 4:return r=e.sent,B.push("/minifigs"),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(1),console.error("Unable to authenticate",e.t0),e.abrupt("return",a(e.t0.response.data));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()),$=Object(R.b)("auth/tryAutoSignIn"),G=Object(R.d)({name:"auth",initialState:Z,reducers:{logout:function(){return Z},autoSignIn:function(e,t){var n=t.payload,a=n.userId,r=n.token;e.token=r,e.userId=a}},extraReducers:function(e){e.addCase(J.pending,(function(e){e.isLoading=!0})),e.addCase(J.fulfilled,(function(e,t){var n=t.payload;e.isLoading=!1,e.token=n.idToken,e.userId=n.localId})),e.addCase(J.rejected,(function(e,t){var n=t.payload;e.isLoading=!1,e.error=n}))}}),_=G.actions,K=_.logout,Q=_.autoSignIn,Y=G.reducer,X=function(e){return!!e.auth.token},ee=function(e){return e.auth.isLoading},te=function(){localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),localStorage.removeItem("userId")},ne=function(e,t){a=setTimeout((function(){t(K())}),new Date(e).getTime()-(new Date).getTime())},ae=function(e){var t=e.dispatch;return function(e){return function(n){if(K.match(n)&&(te(),clearTimeout(a)),$.match(n)){var r=localStorage.getItem("token"),i=localStorage.getItem("expirationDate"),c=localStorage.getItem("userId");return r&&i&&c?new Date(i)<=new Date?te():(ne(i,t),e(Q({token:r,userId:c}))):clearTimeout(a)}if((null===n||void 0===n?void 0:n.type.match(/^auth/))&&Object(R.e)(n)){var o=n.payload,s=o.idToken,l=o.localId,u=o.expiresIn,d=new Date((new Date).getTime()+1e3*parseInt(u,10)).toISOString();ne(d,t),localStorage.setItem("token",s),localStorage.setItem("expirationDate",d),localStorage.setItem("userId",l)}return e(n)}}},re=Y,ie=Object(l.a)((function(){return Object(u.a)({root:{flexGrow:1},title:{flexGrow:1}})})),ce=function(){var e=ie(),t=D(X),n=W(),a=Object(P.g)().push,r=Object(i.useCallback)((function(){n(K()),a("/auth")}),[n,a]);return Object(y.jsx)("div",{className:e.root,children:Object(y.jsx)(d.a,{position:"sticky",children:Object(y.jsxs)(j.a,{variant:"dense",children:[Object(y.jsxs)(b.a,{variant:"h6",className:e.title,children:["Lego SW",Object(y.jsx)(f.a,{smDown:!0,children:" Collection Manager"})]}),Object(y.jsx)(f.a,{mdUp:!0,children:Object(y.jsx)(C,{isAuthenticate:t,logoutHandler:r})}),Object(y.jsx)(f.a,{smDown:!0,children:Object(y.jsx)(T,{isAuthenticate:t,logoutHandler:r})})]})})})},oe=n(213),se=n(214),le=Object(l.a)((function(){return Object(u.a)({container:{position:"fixed",height:"calc(100vh - 48px)"}})})),ue=function(){var e=le();return Object(y.jsxs)(oe.a,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",className:e.container,children:[Object(y.jsx)(se.a,{size:200,thickness:2,disableShrink:!0}),Object(y.jsx)(b.a,{variant:"h5",color:"primary",children:"Loading..."})]})},de=U.a.create({prefixUrl:"https://lego-sw-collection-manager-default-rtdb.europe-west1.firebasedatabase.app"}),je=function(e,t){return null===e||void 0===e?void 0:e.filter((function(e){var n=t.show,a=t.characName,r=t.tag,i=e.possessed,c=e.tags,o=e.characterName,s="all"===n||"owned"===n&&i||"missing"===n&&!i,l=!r||(null===c||void 0===c?void 0:c.includes(r));return s&&(!a||a===o)&&l}))},be=function(){var e=Object(E.a)(V.a.mark((function e(t,n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.put("minifigs.json?auth=".concat(n),{json:t}).json();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),fe=function(e,t){return null===e||void 0===e?void 0:e.findIndex((function(e){return e.id===t}))},pe=Object(R.c)("minifigs/fetchMinifigs",function(){var e=Object(E.a)(V.a.mark((function e(t,n){var a,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.rejectWithValue,e.prev=1,e.next=4,de.get("minifigs.json").json();case 4:return r=e.sent,e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(1),console.error("Unable to fetch minifigs",e.t0),e.abrupt("return",a(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),me=Object(R.c)("minifigs/toggleMinifigOwned",function(){var e=Object(E.a)(V.a.mark((function e(t,n){var a,r,i,c,o,s;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getState,r=n.rejectWithValue,i=a(),c=i.auth.token){e.next=5;break}return e.abrupt("return",t);case 5:if(o=i.minifigs.list,void 0!==(s=fe(o,t))&&-1!==s&&o){e.next=9;break}return e.abrupt("return",r("No minifig with that id"));case 9:return e.prev=9,e.next=12,de.patch("minifigs/".concat(s,".json?auth=").concat(c),{json:{possessed:!o[s].possessed}});case 12:return e.abrupt("return",t);case 15:return e.prev=15,e.t0=e.catch(9),console.error("Unable to toggle minifig owned",e.t0),e.abrupt("return",r(e.t0.message));case 19:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t,n){return e.apply(this,arguments)}}()),he=Object(R.c)("minifigs/editMinifig",function(){var e=Object(E.a)(V.a.mark((function e(t,n){var a,r,i,c,o,s;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getState,r=n.rejectWithValue,i=a(),c=i.auth.token,o=i.minifigs.list,Array.isArray(o)){e.next=6;break}return e.abrupt("return",r("No minifigs list in the store"));case 6:if(s=o.map((function(e){return e.id===t.id?t:e})),c){e.next=9;break}return e.abrupt("return",s);case 9:return e.prev=9,e.next=12,be(s,c);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t0=e.catch(9),console.error("Unable to edit the minifig",e.t0),e.abrupt("return",r(e.t0.message));case 19:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t,n){return e.apply(this,arguments)}}()),ge=Object(R.c)("minifigs/addMinifig",function(){var e=Object(E.a)(V.a.mark((function e(t,n){var a,r,i,c,o,s;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getState,r=n.rejectWithValue,i=a(),c=i.auth.token,o=i.minifigs.list,Array.isArray(o)){e.next=6;break}return e.abrupt("return",r("No minifigs list in the store"));case 6:if(s=o.concat(t).sort((function(e,t){return e.id>t.id?1:-1})),c){e.next=9;break}return e.abrupt("return",s);case 9:return e.prev=9,e.next=12,be(s,c);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t0=e.catch(9),console.error("Unable to add the minifig",e.t0),e.abrupt("return",r(e.t0.message));case 19:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t,n){return e.apply(this,arguments)}}()),Oe=Object(R.c)("minifigs/deleteMinifig",function(){var e=Object(E.a)(V.a.mark((function e(t,n){var a,r,i,c,o,s,l;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getState,r=n.rejectWithValue,i=a(),c=i.auth.token,o=i.minifigs.list,void 0!==(s=fe(o,t))&&-1!==s&&o){e.next=7;break}return e.abrupt("return",r("No minifig with that id"));case 7:if(l=o.filter((function(e){return e.id!==t})),c){e.next=10;break}return e.abrupt("return",l);case 10:return e.prev=10,e.next=13,be(l,c);case 13:return e.abrupt("return",e.sent);case 16:return e.prev=16,e.t0=e.catch(10),console.error("Unable to delete minifig",e.t0),e.abrupt("return",r(e.t0.message));case 20:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t,n){return e.apply(this,arguments)}}()),xe=Object(R.f)(pe,me,he,ge,Oe),ve=Object(R.e)(pe,me,he,ge,Oe),ye=Object(R.g)(pe,me,he,ge,Oe),we=Object(R.d)({name:"minifigs",initialState:{list:null,tags:null,characNames:null,isLoading:!1,error:null,filters:{show:"all",characName:null,tag:null},pagination:{activePage:0,total:0,nbPerPage:50}},reducers:{setMinifigsFilters:function(e,t){var n=Object(N.a)(Object(N.a)({},e.filters),t.payload),a=je(e.list,n);e.filters=n,e.pagination.activePage=0,e.pagination.total=(null===a||void 0===a?void 0:a.length)||0},resetMinifigsFilters:function(e){var t;e.filters={show:"all",tag:null,characName:null},e.pagination.total=(null===(t=e.list)||void 0===t?void 0:t.length)||0,e.pagination.activePage=0},setMinifigsPagination:function(e,t){e.pagination=t.payload}},extraReducers:function(e){e.addCase(me.fulfilled,(function(e,t){var n,a=t.payload,r=null===(n=e.list)||void 0===n?void 0:n.findIndex((function(e){return e.id===a}));-1!==r&&e.list&&void 0!==r&&(e.list[r].possessed=!e.list[r].possessed)})),e.addMatcher(Object(R.e)(ge,pe,Oe,he),(function(e,t){var n=t.payload,a=function(e){var t=e.reduce((function(e,t){var n=t.characterName,a=t.tags,r=e.characNames.findIndex((function(e){return e.name===n}));return-1===r?e.characNames.push({name:n,amount:1}):e.characNames[r].amount++,a&&a.length&&a.forEach((function(t){var n=e.tags.findIndex((function(e){return e.name===t}));-1===n?e.tags.push({name:t,amount:1}):e.tags[n].amount++})),e}),{tags:[],characNames:[]});return t.tags.sort((function(e,t){return e.name>t.name?1:-1})),t.characNames.sort((function(e,t){return e.name>t.name?1:-1})),t}(n),r=a.tags,i=a.characNames;e.list=n,e.pagination.activePage=0,e.pagination.total=n.length,e.tags=r,e.characNames=i,e.filters.characName=i.map((function(e){return e.name})).includes(e.filters.characName||"")?e.filters.characName:null,e.filters.tag=r.map((function(e){return e.name})).includes(e.filters.tag||"")?e.filters.tag:null})),e.addMatcher(xe,(function(e){e.isLoading=!0})),e.addMatcher(ve,(function(e){e.isLoading=!1})),e.addMatcher(ye,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}),ke=we.actions,Ce=ke.setMinifigsFilters,Ne=ke.resetMinifigsFilters,Se=ke.setMinifigsPagination,Ie=we.reducer,Pe=function(e){return e.minifigs.list},Ae=function(e){return{tags:e.minifigs.tags,characNames:e.minifigs.characNames}},Me=function(e){return e.minifigs.filters},Te=function(e){return e.minifigs.pagination},Le=function(e){return e.minifigs.isLoading},We=function(e){var t=e.minifigs.pagination,n=t.nbPerPage,a=t.activePage,r=je(e.minifigs.list,e.minifigs.filters),i=a*n,c=i+n;return null===r||void 0===r?void 0:r.slice(i,c)},De=Ie,Fe=n(223),qe=n(233),ze=Object(l.a)((function(e){return Object(u.a)({spacer:{display:"none",flex:"none"},toolbar:{justifyContent:"center"}})})),Ve=function(){var e=D(Te),t=W(),n=e.activePage,a=e.nbPerPage,r=e.total,c=ze(),o=Object(i.useCallback)((function(e){var t=e.from,n=e.to,i=e.count;return r<=a?"".concat(t," - ").concat(n):"".concat(t," - ").concat(n," of ").concat(i)}),[a,r]);return Object(y.jsx)(qe.a,{"data-testid":"minifigs-pagination",count:r,page:n,component:"div",labelRowsPerPage:"",SelectProps:{"aria-label":"Minifigs per page","data-testid":"minifigs-pagination-select"},rowsPerPageOptions:[{value:25,label:"25/page"},{value:50,label:"50/page"},{value:100,label:"100/page"},{value:200,label:"200/page"}],labelDisplayedRows:o,rowsPerPage:a,onPageChange:function(n,a){t(Se(Object(N.a)(Object(N.a)({},e),{},{activePage:a})))},onRowsPerPageChange:function(n){var a=parseInt(n.target.value,10);t(Se(Object(N.a)(Object(N.a)({},e),{},{nbPerPage:a,activePage:0})))},classes:{spacer:c.spacer,toolbar:c.toolbar}})},Ee=n(163),Re=n(217),Ue=n(227),He=n(242),Be=Object(l.a)((function(e){return Object(u.a)({chip:{margin:e.spacing(.5),borderRadius:"12px",height:"auto",padding:"".concat(e.spacing(.75)," 0"),maxWidth:"calc(100% - ".concat(e.spacing(1),")")},label:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"block"},deleteIcon:{height:e.spacing(1.4),width:e.spacing(1.4)}})})),Ze=function(e){var t=e.tags,n=e.characterName,a=D(Me),r=W(),c=Be(),o=Object(i.useCallback)((function(e){r(Ce({characName:e}))}),[r]),s=Object(i.useCallback)((function(e){r(Ce({tag:e}))}),[r]);return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(He.a,{label:n,"data-testid":"character-name-chip",classes:{root:c.chip,label:c.label,deleteIcon:c.deleteIcon},clickable:n!==a.characName,color:n===a.characName?"primary":"default",onClick:function(){return o(n)},onDelete:n===a.characName?function(){return o(null)}:void 0}),Array.isArray(t)&&t.length>0&&Object(y.jsx)(Re.a,{variant:"fullWidth"}),null===t||void 0===t?void 0:t.map((function(e){return Object(y.jsx)(He.a,{"data-testid":"tag-".concat(e,"-chip"),label:e,classes:{root:c.chip,label:c.label,deleteIcon:c.deleteIcon},clickable:e!==a.tag,color:e===a.tag?"primary":"default",onClick:function(){return s(e)},onDelete:e===a.tag?function(){return s(null)}:void 0},"".concat(n,"-").concat(e))}))]})},Je=n(113),$e=n.n(Je),Ge=n(112),_e=n.n(Ge),Ke=n(238),Qe=n(226),Ye=n(224),Xe=n(40),et=n(218),tt=n(219),nt=n(243),at=n(220),rt=n(235),it=["value","label","options","row"],ct=Object(l.a)((function(e){return Object(u.a)({label:{textTransform:"capitalize"}})})),ot=c.a.forwardRef((function(e,t){var n=e.value,a=e.label,r=e.options,i=e.row,c=Object(Xe.a)(e,it),o=ct();return Object(y.jsxs)(et.a,{component:"fieldset",children:[Object(y.jsx)(tt.a,{component:"legend",children:a}),Object(y.jsx)(nt.a,Object(N.a)(Object(N.a)({ref:t,row:!!i,"aria-label":a,name:a,value:n},c),{},{children:r.map((function(e){return Object(y.jsx)(at.a,{className:o.label,value:e,control:Object(y.jsx)(rt.a,{}),label:e},e)}))}))]})})),st=n(221),lt=n(236),ut=n(237),dt=Object(st.a)(),jt=c.a.forwardRef((function(e,t){var n=e.label,a=e.value,r=e.options,c=e.multiple,o=e.creatable,s=e.placeholder,l=e.muiProps,u=e.onChange,d=Object(i.useState)(c?[]:null),j=Object(p.a)(d,2),b=j[0],f=j[1];Object(i.useEffect)((function(){var e=null;Array.isArray(a)&&c&&!o&&(e=r.filter((function(e){return a.includes(e.value)}))),Array.isArray(a)&&c&&o&&(e=a.map((function(e){return{value:e,label:e,added:!r.map((function(e){return e.value})).includes(e)}}))),!a||Array.isArray(a)||c||(void 0===(e=r.find((function(e){return e.value===a})))&&o&&(e={label:a,value:a,added:!0}),void 0!==e||o||(e=null)),f(e)}),[a,r,c,o]);var m=Object(i.useCallback)((function(e){f(e),Array.isArray(e)?u(e.map((function(e){return e.value}))):u(e?e.value:null)}),[f,u]);return Object(y.jsx)(lt.a,{id:n,multiple:!!c,options:r,autoHighlight:!0,freeSolo:!!o,selectOnFocus:!!o,openOnFocus:!0,clearOnBlur:!!o,handleHomeEndKeys:!!o,value:b,filterOptions:function(e,t){var n=dt(e,t);return""===t.inputValue||!o||(!Array.isArray(b)||b.find((function(e){return e.value===t.inputValue}))||e.find((function(e){return e.value===t.inputValue})))&&Array.isArray(b)||n.push({value:t.inputValue,label:'Add "'.concat(t.inputValue,'"'),added:!0}),n},getOptionSelected:function(e,t){return!(null===t||void 0===t?void 0:t.added)&&e.value===t.value},getOptionLabel:function(e){return e.label},onChange:function(e,t){m(t)},renderInput:function(e){return Object(y.jsx)(ut.a,Object(N.a)(Object(N.a)({},e),{},{ref:t,variant:"outlined",label:n,placeholder:s,InputLabelProps:{shrink:!0}},l))}})})),bt=["muiProps"],ft=c.a.forwardRef((function(e,t){var n=e.muiProps,a=Object(Xe.a)(e,bt);return Object(y.jsx)(ut.a,Object(N.a)(Object(N.a)({variant:"outlined",ref:t,InputLabelProps:{shrink:!0}},n),a))})),pt=n(222),mt=c.a.forwardRef((function(e,t){var n=e.value,a=e.label,r=e.muiProps,i=e.onChange,c=Object(y.jsx)(pt.a,Object(N.a)(Object(N.a)({ref:t,checked:n,value:n,color:"primary"},r),{},{onChange:i}));return a?Object(y.jsx)(at.a,{control:c,labelPlacement:"start",label:a}):c})),ht=["type"],gt=["type"],Ot=["type"],xt=["type"],vt=c.a.forwardRef((function(e,t){if("textfield"===e.type){e.type;var n=Object(Xe.a)(e,ht);return Object(y.jsx)(ft,Object(N.a)(Object(N.a)({},n),{},{ref:t}))}if("switch"===e.type){e.type;var a=Object(Xe.a)(e,gt);return Object(y.jsx)(mt,Object(N.a)(Object(N.a)({},a),{},{ref:t}))}if("autocomplete"===e.type){e.type;var r=Object(Xe.a)(e,Ot);return Object(y.jsx)(jt,Object(N.a)(Object(N.a)({},r),{},{ref:t}))}if("radiobuttons"===e.type){e.type;var i=Object(Xe.a)(e,xt);return Object(y.jsx)(ot,Object(N.a)(Object(N.a)({},i),{},{ref:t}))}return Object(y.jsx)("span",{children:"Input not supported"})})),yt=n(225),wt=n(27),kt=["isLoading","children","disabled"],Ct=Object(l.a)((function(e){return Object(u.a)({loader:{marginLeft:e.spacing(1)}})})),Nt=function(e){var t=e.isLoading,n=e.children,a=e.disabled,r=Object(Xe.a)(e,kt),i=Ct();return Object(y.jsxs)(Fe.a,Object(N.a)(Object(N.a)({disabled:a||t},r),{},{children:[n,t&&Object(y.jsx)(se.a,{className:i.loader,size:"1em",thickness:3})]}))},St=function(e){var t=e.handleClose,n=e.editMinifigData,a=D(Ae),r=a.tags,c=a.characNames,o=D(Pe),s=D(Le),l=W(),u=Object(wt.b)({defaultValues:n||{id:"",name:"",characterName:"",tags:[],possessed:!1},mode:"onChange"}),d=u.control,j=u.reset,b=u.unregister,f=u.handleSubmit,p=u.formState.isValid,m=Object(i.useMemo)((function(){return(null===c||void 0===c?void 0:c.map((function(e){return{label:e.name,value:e.name}})))||[]}),[c]),h=Object(i.useMemo)((function(){return(null===r||void 0===r?void 0:r.map((function(e){return{label:e.name,value:e.name}})))||[]}),[r]),g=Object(i.useMemo)((function(){return(null===o||void 0===o?void 0:o.map((function(e){return e.id})))||[]}),[o]),O=function(){t(),j(),b()};return Object(y.jsx)(Ke.a,{open:!0,onClose:O,"aria-labelledby":"minifig-form-dialog",maxWidth:"md",fullWidth:!0,children:Object(y.jsxs)("form",{onSubmit:f((function(e){return l(n?he(e):ge(e))})),children:[Object(y.jsx)(Ye.a,{id:"minifig-form-dialog",children:n?"Edit ".concat(n.id):"Add a minifig"}),Object(y.jsx)(yt.a,{children:Object(y.jsxs)(oe.a,{container:!0,direction:"column",spacing:2,children:[Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(wt.a,{name:"id",control:d,rules:{required:"This field is required",pattern:{value:/^sw[0-9]{4}[abcds]?$/,message:"This need to be a minifig reference (/^sw[0-9]{4}[abcds]?$/)"},validate:function(e){return!g.includes(e)||e===(null===n||void 0===n?void 0:n.id)||"This minifig already exists"}},render:function(e){var t,a=e.field,r=e.fieldState;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},a),{},{label:"Id",placeholder:"Minifig id (ex: sw0001a)",type:"textfield",muiProps:{disabled:!!n,error:r.invalid,helperText:null===(t=r.error)||void 0===t?void 0:t.message,required:!0,fullWidth:!0}}))}})}),Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(wt.a,{name:"name",control:d,rules:{required:"This field is required"},render:function(e){var t,n=e.field,a=e.fieldState;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},n),{},{label:"Name",placeholder:"Minifig name (ex: Battle Droid Tan with Back Plate)",type:"textfield",muiProps:{error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,required:!0,fullWidth:!0}}))}})}),Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(wt.a,{name:"characterName",control:d,rules:{required:"This field is required"},render:function(e){var t,n=e.field,a=e.fieldState;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},n),{},{label:"Character Name",placeholder:"Character name (ex: Battle Droid)",type:"autocomplete",creatable:!0,options:m,muiProps:{error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,required:!0,fullWidth:!0}}))}})}),Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(wt.a,{name:"tags",control:d,render:function(e){var t=e.field;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},t),{},{label:"Tags",placeholder:"Minifig tags (ex: Battle Droid, CIS, Droid)",type:"autocomplete",creatable:!0,options:h,multiple:!0,muiProps:{fullWidth:!0}}))}})}),Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(wt.a,{name:"possessed",control:d,render:function(e){var t=e.field;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},t),{},{label:"Possessed",type:"switch"}))}})})]})}),Object(y.jsxs)(Qe.a,{children:[Object(y.jsx)(Nt,{onClick:O,color:"primary",disabled:s,children:"Cancel"}),Object(y.jsx)(Nt,{type:"submit",color:"primary",variant:"contained","aria-label":"Submit",disabled:!p,isLoading:s,children:"Submit"})]})]})})},It=Object(l.a)((function(e){return Object(u.a)({container:{paddingTop:e.spacing(.5)}})})),Pt=function(e){var t=e.possessed,n=e.id,a=It(),r=q(),i=Object(p.a)(r,2),c=i[0],o=i[1],s=q(),l=Object(p.a)(s,2),u=l[0],d=l[1],j=D(Le),b=W();return Object(y.jsxs)(oe.a,{container:!0,className:a.container,justifyContent:"space-evenly",alignItems:"center",children:[Object(y.jsx)(Ue.a,{title:"Switch possession","aria-label":"Switch possession",children:Object(y.jsx)("span",{children:Object(y.jsx)(vt,{type:"switch",value:t,onChange:function(){return b(me(n))},muiProps:{disabled:j}})})}),Object(y.jsx)(Ue.a,{title:"Edit","aria-label":"Edit",children:Object(y.jsx)(m.a,{onClick:function(){return o()},children:Object(y.jsx)(_e.a,{})})}),c&&Object(y.jsx)(St,{handleClose:function(){return o()},editMinifigData:e}),Object(y.jsx)(Ue.a,{title:"Delete","aria-label":"Delete",children:Object(y.jsx)(m.a,{disabled:j,onClick:function(){return d()},children:Object(y.jsx)($e.a,{})})}),u&&Object(y.jsxs)(Ke.a,{open:!0,onClose:function(){return d()},"aria-labelledby":"minifig-delete-dialog",maxWidth:"md",children:[Object(y.jsx)(Ye.a,{id:"minifig-delete-dialog",children:"Are you sure you want to delete ".concat(n,"?")}),Object(y.jsxs)(Qe.a,{children:[Object(y.jsx)(Nt,{onClick:function(){return d()},color:"primary",disabled:j,children:"Cancel"}),Object(y.jsx)(Nt,{type:"submit",color:"secondary",variant:"contained",isLoading:j,onClick:function(){return b(Oe(n))},children:"Confirm"})]})]})]})},At=n.p+"static/media/brickset.cdd8ff5b.png",Mt=n.p+"static/media/bricklink.7488f58e.png",Tt=Object(l.a)((function(e){return Object(u.a)({icon:{"& img":{height:"2rem",width:"2rem"},margin:e.spacing(.5),padding:e.spacing(.7)}})})),Lt=function(e){var t=e.bricklink,n=e.minifig,a=e.id,r=Tt(),c=Object(i.useMemo)((function(){return t?"https://www.bricklink.com/v2/catalog/catalogitem.page?".concat(n?"M":"S","=").concat(a):"https://brickset.com/".concat(n?"minifigs":"sets","/").concat(a)}),[t,n,a]);return Object(y.jsx)(m.a,{className:r.icon,href:c,children:Object(y.jsx)("img",{alt:t?"bricklink-logo":"brickset-logo",src:t?Mt:At})})},Wt=Object(l.a)((function(e){return Object(u.a)({paper:{display:"flex",textAlign:"center",margin:e.spacing(1),padding:e.spacing(.5),boxSizing:"border-box",height:"calc(100% - ".concat(e.spacing(1),")")},picture:{width:"auto",maxWidth:"90%",maxHeight:"100%"},reference:{textTransform:"uppercase"},item:{width:"100%","& hr":{width:"calc(100% + ".concat(e.spacing(1),")"),marginLeft:e.spacing(-.5)}},tooltip:{textAlign:"center",maxWidth:"15em"}})})),Dt=function(e){var t=Wt(),n=e.id,a=e.characterName,r=e.name,i=e.tags;return Object(y.jsx)(Ee.a,{className:t.paper,children:Object(y.jsxs)(oe.a,{container:!0,direction:"column",justifyContent:"space-between",children:[Object(y.jsx)(oe.a,{item:!0,children:Object(y.jsx)(Ue.a,{title:r,classes:{tooltip:t.tooltip},children:Object(y.jsx)("img",{className:t.picture,src:"https://img.bricklink.com/ItemImage/MN/0/".concat(n,".png"),alt:"".concat(n,"-bricklink-png")})})}),Object(y.jsxs)(oe.a,{item:!0,className:t.item,children:[Object(y.jsx)(b.a,{className:t.reference,children:n}),Object(y.jsx)(Re.a,{variant:"fullWidth"}),Object(y.jsx)(Ze,{characterName:a,tags:i}),Object(y.jsx)(Re.a,{variant:"fullWidth"}),Object(y.jsx)(Lt,{id:n,bricklink:!0,minifig:!0}),Object(y.jsx)(Lt,{id:n,brickset:!0,minifig:!0}),Object(y.jsx)(Re.a,{variant:"fullWidth"}),Object(y.jsx)(Pt,Object(N.a)({},e))]})]})})},Ft=Object(l.a)((function(e){return Object(u.a)({resetFilters:{marginTop:e.spacing(2)}})})),qt=function(){var e=D(We),t=W(),n=Ft();return Array.isArray(e)?0===e.length?Object(y.jsxs)(oe.a,{container:!0,justifyContent:"center",direction:"column",alignItems:"center",className:n.resetFilters,children:[Object(y.jsx)(b.a,{align:"center",variant:"h6",children:"There are no minifigs with those filters"}),Object(y.jsx)(Fe.a,{variant:"contained",onClick:function(){return t(Ne())},children:"Reset filters"})]}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(Ve,{})}),e.map((function(e){return Object(y.jsx)(oe.a,{item:!0,xs:6,sm:4,md:3,lg:2,children:Object(y.jsx)(Dt,Object(N.a)({},e))},e.id)})),Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(Ve,{})})]}):null},zt=n(78),Vt=n.n(zt),Et=function(){var e=D(Ae),t=e.tags,n=e.characNames,a=W(),r=D(Me),c=F(r),o=Object(wt.b)({defaultValues:r}),s=o.control,l=o.reset,u=Object(wt.c)({control:s,defaultValue:r}),d=F(u);Object(i.useEffect)((function(){Vt()(r,u)||Vt()(d,u)||a(Ce(u))}),[a,u,d,r]),Object(i.useEffect)((function(){Vt()(r,c)||Vt()(r,u)||l(r)}),[r,c,u,l]);var j=Object(i.useMemo)((function(){return(null===n||void 0===n?void 0:n.map((function(e){return{label:"".concat(e.name," (").concat(e.amount,")"),value:e.name}})))||[]}),[n]),b=Object(i.useMemo)((function(){return(null===t||void 0===t?void 0:t.map((function(e){return{label:"".concat(e.name," (").concat(e.amount,")"),value:e.name}})))||[]}),[t]);return Object(y.jsxs)(oe.a,{container:!0,direction:"column",spacing:2,children:[Object(y.jsx)(oe.a,{item:!0,children:Object(y.jsx)(wt.a,{name:"show",control:s,render:function(e){var t=e.field;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},t),{},{label:"Show",type:"radiobuttons",row:!0,options:["all","owned","missing"]}))}})}),Object(y.jsx)(oe.a,{item:!0,children:Object(y.jsx)(wt.a,{name:"characName",control:s,render:function(e){var t=e.field;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},t),{},{label:"Character Name",type:"autocomplete",placeholder:"Filter by character name",options:j}))}})}),Object(y.jsx)(oe.a,{item:!0,children:Object(y.jsx)(wt.a,{name:"tag",control:s,render:function(e){var t=e.field;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},t),{},{label:"Tag",type:"autocomplete",placeholder:"Filter by tag",options:b}))}})})]})},Rt=n(114),Ut=n.n(Rt),Ht=n(115),Bt=n.n(Ht),Zt=function(){var e=q(!1),t=Object(p.a)(e,2),n=t[0],a=t[1],r=D(Pe),i=function(e){var t=e.length,n=e.filter((function(e){return e.possessed})).length;return{totalNumber:t,numberOwned:n,percentageOwned:Math.round(n/t*1e4)/100}}(r||[]),c=i.totalNumber,o=i.numberOwned,s=i.percentageOwned;return Object(y.jsxs)(oe.a,{container:!0,direction:"column",spacing:4,children:[Object(y.jsx)(oe.a,{item:!0,children:Object(y.jsx)(b.a,{align:"center",variant:"h6",children:"You owned ".concat(o," of the ").concat(c," minifigs in our database (").concat(s,"%)")})}),Object(y.jsx)(Re.a,{}),Object(y.jsx)(oe.a,{item:!0,children:Object(y.jsxs)(oe.a,{container:!0,justifyContent:"space-evenly",children:[Object(y.jsx)(Fe.a,{variant:"contained",color:"primary",onClick:function(){return a()},endIcon:Object(y.jsx)(Ut.a,{}),children:"Add a minifig"}),n&&Object(y.jsx)(St,{handleClose:function(){return a(!1)}}),Object(y.jsx)(Fe.a,{variant:"contained",color:"primary",endIcon:Object(y.jsx)(Bt.a,{}),href:"data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(r))),download:"minifigsList.json",target:"_blank",rel:"noopener noreferrer",children:"Download minifigs"})]})})]})},Jt=Object(l.a)((function(e){return Object(u.a)({paper:{padding:e.spacing(2),margin:e.spacing(2),boxSizing:"border-box",minHeight:"calc(100% - ".concat(e.spacing(4),")")}})})),$t=function(){var e=Jt();return Object(y.jsxs)(oe.a,{container:!0,children:[Object(y.jsx)(oe.a,{item:!0,xs:12,md:6,children:Object(y.jsx)(Ee.a,{className:e.paper,children:Object(y.jsx)(Zt,{})})}),Object(y.jsx)(oe.a,{item:!0,xs:12,md:6,children:Object(y.jsx)(Ee.a,{className:e.paper,children:Object(y.jsx)(Et,{})})})]})},Gt=function(){var e=W(),t=D(Pe),n=D(Le);return Object(i.useEffect)((function(){!t&&e(pe())}),[t,e]),!Array.isArray(t)&&n?Object(y.jsx)(ue,{}):Object(y.jsxs)(oe.a,{container:!0,justifyContent:"center",alignItems:"stretch",children:[Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)($t,{})}),Object(y.jsx)(qt,{})]})},_t=n(228),Kt=n(116),Qt=n.n(Kt),Yt=n(117),Xt=n.n(Yt),en=Object(l.a)((function(e){return Object(u.a)({paper:{padding:e.spacing(2),margin:e.spacing(2),boxSizing:"border-box",minHeight:"calc(100% - ".concat(e.spacing(4),")")}})})),tn=function(){var e=q(),t=Object(p.a)(e,2),n=t[0],a=t[1],r=W(),i=D(ee),c=Object(wt.b)({defaultValues:{email:"",password:""},mode:"onChange"}),o=c.control,s=c.handleSubmit,l=c.formState.isValid,u=en();return Object(y.jsx)(Ee.a,{component:"form",onSubmit:s((function(e){return r(J(e))})),className:u.paper,children:Object(y.jsxs)(oe.a,{container:!0,justifyContent:"center",spacing:2,children:[Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(wt.a,{name:"email",control:o,rules:{required:"This field is required",pattern:{value:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,message:"This need to be a valid email"}},render:function(e){var t,n=e.field,a=e.fieldState;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},n),{},{label:"Email",id:"email",placeholder:"Email@exemple.com",type:"textfield",muiProps:{error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,required:!0,fullWidth:!0}}))}})}),Object(y.jsx)(oe.a,{item:!0,xs:12,children:Object(y.jsx)(wt.a,{name:"password",control:o,rules:{required:"This field is required"},render:function(e){var t,r=e.field,i=e.fieldState;return Object(y.jsx)(vt,Object(N.a)(Object(N.a)({},r),{},{label:"Password",id:"password",type:"textfield",muiProps:{error:i.invalid,helperText:null===(t=i.error)||void 0===t?void 0:t.message,required:!0,fullWidth:!0,type:n?"text":"password",InputProps:{endAdornment:Object(y.jsx)(_t.a,{position:"end",children:Object(y.jsx)(m.a,{"aria-label":"toggle password visibility",onClick:function(){return a()},onMouseDown:function(e){return e.preventDefault()},children:n?Object(y.jsx)(Qt.a,{}):Object(y.jsx)(Xt.a,{})})})}}}))}})}),Object(y.jsx)(Nt,{type:"submit",color:"primary",variant:"contained",disabled:!l,isLoading:i,children:"Submit"})]})})},nn=function(){return Object(y.jsxs)(P.d,{children:[Object(y.jsx)(P.b,{path:"/minifigs",component:Gt}),Object(y.jsx)(P.b,{exact:!0,path:"/auth",component:tn}),Object(y.jsx)(P.a,{to:"/minifigs"})]})},an=function(){var e=W();return Object(i.useEffect)((function(){e($())}),[e]),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(ce,{}),Object(y.jsx)(nn,{})]})},rn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,244)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))},cn=function(e){var t=e.children;return Object(y.jsx)(P.c,{history:B,children:t})},on=n(118),sn=n(229),ln=Object(on.a)({spacing:function(e){return"".concat(.5*e,"em")}}),un=function(e){var t=e.children;return Object(y.jsx)(sn.a,{theme:ln,children:t})},dn=n(45),jn=Object(dn.b)({minifigs:De,auth:re}),bn=Object(R.a)({reducer:jn,preloadedState:r,middleware:function(e){return e().concat(ae)}}),fn=function(e){var t=e.children;return Object(y.jsx)(L.a,{store:bn,children:t})},pn=function(e){var t=e.children;return Object(y.jsx)(cn,{children:Object(y.jsx)(fn,{children:Object(y.jsx)(un,{children:t})})})};s.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(pn,{children:Object(y.jsx)(an,{})})}),document.getElementById("root")),rn()}},[[158,1,2]]]);
//# sourceMappingURL=main.ef5c04f8.chunk.js.map